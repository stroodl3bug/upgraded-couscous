{"version":3,"file":"spotify-card.js","sources":["../node_modules/preact/dist/preact.module.js","../node_modules/htm/dist/htm.module.js","../src/PlayerSelect.js","../src/SpotifyCard.js","../src/spotify-card.js"],"sourcesContent":["var n,l,u,i,t,o,r,f,e={},c=[],a=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function s(n,l){for(var u in l)n[u]=l[u];return n}function v(n){var l=n.parentNode;l&&l.removeChild(n)}function h(n,l,u){var i,t=arguments,o={};for(i in l)\"key\"!==i&&\"ref\"!==i&&(o[i]=l[i]);if(arguments.length>3)for(u=[u],i=3;i<arguments.length;i++)u.push(t[i]);if(null!=u&&(o.children=u),\"function\"==typeof n&&null!=n.defaultProps)for(i in n.defaultProps)void 0===o[i]&&(o[i]=n.defaultProps[i]);return y(n,o,l&&l.key,l&&l.ref,null)}function y(l,u,i,t,o){var r={type:l,props:u,key:i,ref:t,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:o};return null==o&&(r.__v=r),n.vnode&&n.vnode(r),r}function p(){return{}}function d(n){return n.children}function m(n,l){this.props=n,this.context=l}function w(n,l){if(null==l)return n.__?w(n.__,n.__.__k.indexOf(n)+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?w(n):null}function k(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return k(n)}}function g(l){(!l.__d&&(l.__d=!0)&&u.push(l)&&!i++||o!==n.debounceRendering)&&((o=n.debounceRendering)||t)(_)}function _(){for(var n;i=u.length;)n=u.sort(function(n,l){return n.__v.__b-l.__v.__b}),u=[],n.some(function(n){var l,u,i,t,o,r,f;n.__d&&(r=(o=(l=n).__v).__e,(f=l.__P)&&(u=[],(i=s({},o)).__v=i,t=z(f,o,i,l.__n,void 0!==f.ownerSVGElement,null,u,null==r?w(o):r),T(u,o),t!=r&&k(o)))})}function b(n,l,u,i,t,o,r,f,a,s){var h,p,m,k,g,_,b,x,A,P=i&&i.__k||c,C=P.length;for(a==e&&(a=null!=r?r[0]:C?w(i,0):null),u.__k=[],h=0;h<l.length;h++)if(null!=(k=u.__k[h]=null==(k=l[h])||\"boolean\"==typeof k?null:\"string\"==typeof k||\"number\"==typeof k?y(null,k,null,null,k):Array.isArray(k)?y(d,{children:k},null,null,null):null!=k.__e||null!=k.__c?y(k.type,k.props,k.key,null,k.__v):k)){if(k.__=u,k.__b=u.__b+1,null===(m=P[h])||m&&k.key==m.key&&k.type===m.type)P[h]=void 0;else for(p=0;p<C;p++){if((m=P[p])&&k.key==m.key&&k.type===m.type){P[p]=void 0;break}m=null}if(g=z(n,k,m=m||e,t,o,r,f,a,s),(p=k.ref)&&m.ref!=p&&(x||(x=[]),m.ref&&x.push(m.ref,null,k),x.push(p,k.__c||g,k)),null!=g){if(null==b&&(b=g),A=void 0,void 0!==k.__d)A=k.__d,k.__d=void 0;else if(r==m||g!=a||null==g.parentNode){n:if(null==a||a.parentNode!==n)n.appendChild(g),A=null;else{for(_=a,p=0;(_=_.nextSibling)&&p<C;p+=2)if(_==g)break n;n.insertBefore(g,a),A=a}\"option\"==u.type&&(n.value=\"\")}a=void 0!==A?A:g.nextSibling,\"function\"==typeof u.type&&(u.__d=a)}else a&&m.__e==a&&a.parentNode!=n&&(a=w(m))}if(u.__e=b,null!=r&&\"function\"!=typeof u.type)for(h=r.length;h--;)null!=r[h]&&v(r[h]);for(h=C;h--;)null!=P[h]&&D(P[h],P[h]);if(x)for(h=0;h<x.length;h++)j(x[h],x[++h],x[++h])}function x(n){return null==n||\"boolean\"==typeof n?[]:Array.isArray(n)?c.concat.apply([],n.map(x)):[n]}function A(n,l,u,i,t){var o;for(o in u)\"children\"===o||\"key\"===o||o in l||C(n,o,null,u[o],i);for(o in l)t&&\"function\"!=typeof l[o]||\"children\"===o||\"key\"===o||\"value\"===o||\"checked\"===o||u[o]===l[o]||C(n,o,l[o],u[o],i)}function P(n,l,u){\"-\"===l[0]?n.setProperty(l,u):n[l]=\"number\"==typeof u&&!1===a.test(l)?u+\"px\":null==u?\"\":u}function C(n,l,u,i,t){var o,r,f,e,c;if(t?\"className\"===l&&(l=\"class\"):\"class\"===l&&(l=\"className\"),\"style\"===l)if(o=n.style,\"string\"==typeof u)o.cssText=u;else{if(\"string\"==typeof i&&(o.cssText=\"\",i=null),i)for(e in i)u&&e in u||P(o,e,\"\");if(u)for(c in u)i&&u[c]===i[c]||P(o,c,u[c])}else\"o\"===l[0]&&\"n\"===l[1]?(r=l!==(l=l.replace(/Capture$/,\"\")),f=l.toLowerCase(),l=(f in n?f:l).slice(2),u?(i||n.addEventListener(l,N,r),(n.l||(n.l={}))[l]=u):n.removeEventListener(l,N,r)):\"list\"!==l&&\"tagName\"!==l&&\"form\"!==l&&\"type\"!==l&&\"size\"!==l&&!t&&l in n?n[l]=null==u?\"\":u:\"function\"!=typeof u&&\"dangerouslySetInnerHTML\"!==l&&(l!==(l=l.replace(/^xlink:?/,\"\"))?null==u||!1===u?n.removeAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase()):n.setAttributeNS(\"http://www.w3.org/1999/xlink\",l.toLowerCase(),u):null==u||!1===u&&!/^ar/.test(l)?n.removeAttribute(l):n.setAttribute(l,u))}function N(l){this.l[l.type](n.event?n.event(l):l)}function z(l,u,i,t,o,r,f,e,c){var a,v,h,y,p,w,k,g,_,x,A,P=u.type;if(void 0!==u.constructor)return null;(a=n.__b)&&a(u);try{n:if(\"function\"==typeof P){if(g=u.props,_=(a=P.contextType)&&t[a.__c],x=a?_?_.props.value:a.__:t,i.__c?k=(v=u.__c=i.__c).__=v.__E:(\"prototype\"in P&&P.prototype.render?u.__c=v=new P(g,x):(u.__c=v=new m(g,x),v.constructor=P,v.render=E),_&&_.sub(v),v.props=g,v.state||(v.state={}),v.context=x,v.__n=t,h=v.__d=!0,v.__h=[]),null==v.__s&&(v.__s=v.state),null!=P.getDerivedStateFromProps&&(v.__s==v.state&&(v.__s=s({},v.__s)),s(v.__s,P.getDerivedStateFromProps(g,v.__s))),y=v.props,p=v.state,h)null==P.getDerivedStateFromProps&&null!=v.componentWillMount&&v.componentWillMount(),null!=v.componentDidMount&&v.__h.push(v.componentDidMount);else{if(null==P.getDerivedStateFromProps&&g!==y&&null!=v.componentWillReceiveProps&&v.componentWillReceiveProps(g,x),!v.__e&&null!=v.shouldComponentUpdate&&!1===v.shouldComponentUpdate(g,v.__s,x)||u.__v===i.__v){for(v.props=g,v.state=v.__s,u.__v!==i.__v&&(v.__d=!1),v.__v=u,u.__e=i.__e,u.__k=i.__k,v.__h.length&&f.push(v),a=0;a<u.__k.length;a++)u.__k[a]&&(u.__k[a].__=u);break n}null!=v.componentWillUpdate&&v.componentWillUpdate(g,v.__s,x),null!=v.componentDidUpdate&&v.__h.push(function(){v.componentDidUpdate(y,p,w)})}v.context=x,v.props=g,v.state=v.__s,(a=n.__r)&&a(u),v.__d=!1,v.__v=u,v.__P=l,a=v.render(v.props,v.state,v.context),null!=v.getChildContext&&(t=s(s({},t),v.getChildContext())),h||null==v.getSnapshotBeforeUpdate||(w=v.getSnapshotBeforeUpdate(y,p)),A=null!=a&&a.type==d&&null==a.key?a.props.children:a,b(l,Array.isArray(A)?A:[A],u,i,t,o,r,f,e,c),v.base=u.__e,v.__h.length&&f.push(v),k&&(v.__E=v.__=null),v.__e=!1}else null==r&&u.__v===i.__v?(u.__k=i.__k,u.__e=i.__e):u.__e=$(i.__e,u,i,t,o,r,f,c);(a=n.diffed)&&a(u)}catch(l){u.__v=null,n.__e(l,u,i)}return u.__e}function T(l,u){n.__c&&n.__c(u,l),l.some(function(u){try{l=u.__h,u.__h=[],l.some(function(n){n.call(u)})}catch(l){n.__e(l,u.__v)}})}function $(n,l,u,i,t,o,r,f){var a,s,v,h,y,p=u.props,d=l.props;if(t=\"svg\"===l.type||t,null!=o)for(a=0;a<o.length;a++)if(null!=(s=o[a])&&((null===l.type?3===s.nodeType:s.localName===l.type)||n==s)){n=s,o[a]=null;break}if(null==n){if(null===l.type)return document.createTextNode(d);n=t?document.createElementNS(\"http://www.w3.org/2000/svg\",l.type):document.createElement(l.type,d.is&&{is:d.is}),o=null,f=!1}if(null===l.type)p!==d&&n.data!=d&&(n.data=d);else{if(null!=o&&(o=c.slice.call(n.childNodes)),v=(p=u.props||e).dangerouslySetInnerHTML,h=d.dangerouslySetInnerHTML,!f){if(null!=o)for(p={},y=0;y<n.attributes.length;y++)p[n.attributes[y].name]=n.attributes[y].value;(h||v)&&(h&&v&&h.__html==v.__html||(n.innerHTML=h&&h.__html||\"\"))}A(n,d,p,t,f),h?l.__k=[]:(a=l.props.children,b(n,Array.isArray(a)?a:[a],l,u,i,\"foreignObject\"!==l.type&&t,o,r,e,f)),f||(\"value\"in d&&void 0!==(a=d.value)&&a!==n.value&&C(n,\"value\",a,p.value,!1),\"checked\"in d&&void 0!==(a=d.checked)&&a!==n.checked&&C(n,\"checked\",a,p.checked,!1))}return n}function j(l,u,i){try{\"function\"==typeof l?l(u):l.current=u}catch(l){n.__e(l,i)}}function D(l,u,i){var t,o,r;if(n.unmount&&n.unmount(l),(t=l.ref)&&(t.current&&t.current!==l.__e||j(t,null,u)),i||\"function\"==typeof l.type||(i=null!=(o=l.__e)),l.__e=l.__d=void 0,null!=(t=l.__c)){if(t.componentWillUnmount)try{t.componentWillUnmount()}catch(l){n.__e(l,u)}t.base=t.__P=null}if(t=l.__k)for(r=0;r<t.length;r++)t[r]&&D(t[r],u,i);null!=o&&v(o)}function E(n,l,u){return this.constructor(n,u)}function H(l,u,i){var t,o,f;n.__&&n.__(l,u),o=(t=i===r)?null:i&&i.__k||u.__k,l=h(d,null,[l]),f=[],z(u,(t?u:i||u).__k=l,o||e,e,void 0!==u.ownerSVGElement,i&&!t?[i]:o?null:u.childNodes.length?c.slice.call(u.childNodes):null,f,i||e,t),T(f,l)}function I(n,l){H(n,l,r)}function L(n,l){var u,i;for(i in l=s(s({},n.props),l),arguments.length>2&&(l.children=c.slice.call(arguments,2)),u={},l)\"key\"!==i&&\"ref\"!==i&&(u[i]=l[i]);return y(n.type,u,l.key||n.key,l.ref||n.ref,null)}function M(n){var l={},u={__c:\"__cC\"+f++,__:n,Consumer:function(n,l){return n.children(l)},Provider:function(n){var i,t=this;return this.getChildContext||(i=[],this.getChildContext=function(){return l[u.__c]=t,l},this.shouldComponentUpdate=function(n){t.props.value!==n.value&&i.some(function(l){l.context=n.value,g(l)})},this.sub=function(n){i.push(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){i.splice(i.indexOf(n),1),l&&l.call(n)}}),n.children}};return u.Consumer.contextType=u,u.Provider.__=u,u}n={__e:function(n,l){for(var u,i;l=l.__;)if((u=l.__c)&&!u.__)try{if(u.constructor&&null!=u.constructor.getDerivedStateFromError&&(i=!0,u.setState(u.constructor.getDerivedStateFromError(n))),null!=u.componentDidCatch&&(i=!0,u.componentDidCatch(n)),i)return g(u.__E=u)}catch(l){n=l}throw n}},l=function(n){return null!=n&&void 0===n.constructor},m.prototype.setState=function(n,l){var u;u=this.__s!==this.state?this.__s:this.__s=s({},this.state),\"function\"==typeof n&&(n=n(u,this.props)),n&&s(u,n),null!=n&&this.__v&&(l&&this.__h.push(l),g(this))},m.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),g(this))},m.prototype.render=d,u=[],i=0,t=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,r=e,f=0;export{H as render,I as hydrate,h as createElement,h,d as Fragment,p as createRef,l as isValidElement,m as Component,L as cloneElement,M as createContext,x as toChildArray,D as _unmount,n as options};\n//# sourceMappingURL=preact.module.js.map\n","var n=function(t,s,r,e){var u;s[0]=0;for(var h=1;h<s.length;h++){var p=s[h++],a=s[h]?(s[0]|=p?1:2,r[s[h++]]):s[++h];3===p?e[0]=a:4===p?e[1]=Object.assign(e[1]||{},a):5===p?(e[1]=e[1]||{})[s[++h]]=a:6===p?e[1][s[++h]]+=a+\"\":p?(u=t.apply(a,n(t,a,r,[\"\",null])),e.push(u),a[0]?s[0]|=2:(s[h-2]=0,s[h]=u)):e.push(a)}return e},t=new Map;export default function(s){var r=t.get(this);return r||(r=new Map,t.set(this,r)),(r=n(this,r.get(s)||(r.set(s,r=function(n){for(var t,s,r=1,e=\"\",u=\"\",h=[0],p=function(n){1===r&&(n||(e=e.replace(/^\\s*\\n\\s*|\\s*\\n\\s*$/g,\"\")))?h.push(0,n,e):3===r&&(n||e)?(h.push(3,n,e),r=2):2===r&&\"...\"===e&&n?h.push(4,n,0):2===r&&e&&!n?h.push(5,0,!0,e):r>=5&&((e||!n&&5===r)&&(h.push(r,0,e,s),r=6),n&&(h.push(r,n,0,s),r=6)),e=\"\"},a=0;a<n.length;a++){a&&(1===r&&p(),p(a));for(var l=0;l<n[a].length;l++)t=n[a][l],1===r?\"<\"===t?(p(),h=[h],r=3):e+=t:4===r?\"--\"===e&&\">\"===t?(r=1,e=\"\"):e=t+e[0]:u?t===u?u=\"\":e+=t:'\"'===t||\"'\"===t?u=t:\">\"===t?(p(),r=1):r&&(\"=\"===t?(r=5,s=e,e=\"\"):\"/\"===t&&(r<5||\">\"===n[a][l+1])?(p(),3===r&&(h=h[0]),r=h,(h=h[0]).push(2,0,r),r=0):\" \"===t||\"\\t\"===t||\"\\n\"===t||\"\\r\"===t?(p(),r=2):e+=t),3===r&&\"!--\"===e&&(r=4,h=h[0])}return p(),h}(s)),r),arguments,[])).length>1?r:r[0]}\n","import { h, Component } from 'preact';\nimport htm from 'htm';\n\nconst html = htm.bind(h);\n\nexport default class PlayerSelect extends Component {\n  constructor() {\n    super();\n    this.state = {\n      selectedDevice: '-- choose mediaplayer --',\n      castEntities: [],\n    };\n  }\n\n  componentWillUnmount() {\n    typeof this.unsubscribeEntitites === 'function' && this.unsubscribeEntitites();\n  }\n\n  async componentDidMount() {\n    await this.refreshCastEntities();\n    this.dataRefreshToken = setInterval(async () => {\n      await this.refreshCastEntities();\n    }, 5000); // TODO: check if we can use the mp.spotify state instead?\n  }\n\n  async refreshCastEntities() {\n    const res = await this.props.hass.callWS({\n      type: 'config/entity_registry/list',\n    });\n    const castEntities = res\n      .filter(e => e.platform == 'cast')\n      .map(e => this.props.hass.states[e.entity_id])\n      .filter(e => e != null && e.state != 'unavailable')\n    this.setState({ castEntities });\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.dataRefreshToken);\n  }\n\n  componentWillReceiveProps(props, state) {\n    if (props.selectedDevice) {\n      this.setState({ selectedDevice: props.selectedDevice.name });\n    }\n  }\n\n  selectDevice(device) {\n    this.setState({ selectedDevice: device.name });\n    this.props.onMediaplayerSelect(device);\n  }\n\n  selectChromecastDevice(device) {\n    this.props.onChromecastDeviceSelect(device);\n  }\n\n  render() {\n    const { devices } = this.props;\n    const { castEntities } = this.state;\n    const choice_form = html`\n      <div class=\"dropdown-content\">\n        <a onClick=${() => {}}><i>Spotify Connect devices</i></a>\n        ${devices.map(\n          (device, idx) => html`\n            <a onClick=${() => this.selectDevice(device)} style=\"margin-left: 15px\">${device.name}</a>\n          `\n        )}\n        <a onClick=${() => {}}><i>Chromecast devices</i></a>\n        ${castEntities.map(\n          entitiy => html`\n            <a onClick=${() => this.selectChromecastDevice(entitiy.attributes.friendly_name)} style=\"margin-left: 15px\"\n              >${entitiy.attributes.friendly_name}</a\n            >\n          `\n        )}\n      </div>\n    `;\n\n    let form = '';\n    if (this.props.player && this.props.player == this.state.selectedDevice) {\n      form = ''; // We have selected the player already\n    } else if (this.props.player && this.props.player != this.state.selectedDevice) {\n      const selected = devices.filter(d => d.name == this.props.player);\n      if (selected.length == 1) {\n        form = '';\n        this.selectDevice(selected[0]);\n      } else {\n        // console.log(`Was not able to find player ${this.props.player} within ${JSON.stringify(devices)}`);\n        form = choice_form;\n      }\n    } else {\n      form = choice_form;\n    }\n\n    return html`\n    <div class=\"dropdown-wrapper\">\n      <div class=\"controls\">\n      <div class=\"dropdown\">\n        <div class=\"mediaplayer_select\">\n          <svg\n            class=\"mediaplayer_speaker_icon\"\n            width=\"220\"\n            height=\"220\"\n            viewBox=\"0 0 220 220\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              fill=\"#c9c9c9\"\n              d=\"M197.766 112.275q0 56.608-34.867 105.006l-8.157-6.984q32.743-44.355 32.743-98.022 0-52.565-32.632-97.9l8.158-6.984q34.755 48.398 34.755 104.884zm-24.586 0q0 46.928-28.831 88.22l-8.158-6.74q26.708-38.228 26.708-81.48 0-43.13-26.708-81.359l8.158-6.74q28.831 40.435 28.831 88.099zm-24.585 0q0 37.126-22.908 71.434l-8.27-6.617q20.897-30.632 20.897-64.817 0-33.573-20.897-64.818l8.27-6.616q22.908 34.308 22.908 71.434zm-54.646 89.2l-52.634-53.3H8.125V76.374h33.302l52.522-53.177v178.278z\"\n              stroke=\"null\"\n            />\n          </svg>\n          ${this.state.selectedDevice}\n        </div>\n      </div>\n      </div>\n      ${form}\n      </div>\n    `;\n  }\n}\n","import { h, Component } from 'preact';\nimport htm from 'htm';\nimport PlayerSelect from './PlayerSelect';\n\nconst html = htm.bind(h);\n\nexport default class SpotifyCard extends Component {\n  constructor(props) {\n    super(props);\n    this.dataRefreshToken = null;\n    this.state = {\n      playlists: [],\n      devices: [],\n      playlists: [],\n      selectedDevice: null,\n      selectedPlaylist: null,\n      currentPlayer: null,\n      playingPlaylist: null,\n      authenticationRequired: true,\n    };\n    this.scopes = [\n      'playlist-read-private',\n      'playlist-read-collaborative',\n      'user-read-playback-state',\n      'user-modify-playback-state',\n    ];\n  }\n\n  async componentDidMount() {\n    document.addEventListener('visibilitychange', async () => {\n      if (!document.hidden) {\n        await this.refreshPlayData();\n      }\n    });\n    await this.checkAuthentication();\n    await this.refreshPlayData();\n\n    this.dataRefreshToken = setInterval(async () => {\n      await this.refreshPlayData();\n    }, 10000); // TODO: check if we can use the mp.spotify state instead?\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.dataRefreshToken);\n  }\n\n  getLocalStorageTokenName() {\n    const account = this.props.account ? this.props.account : 'default';\n    return 'spotify-access_token-' + account;\n  }\n\n  async checkAuthentication() {\n    const hashParams = new URLSearchParams(window.location.hash.substring(1));\n    const access_token = hashParams.get('access_token') || localStorage.getItem(this.getLocalStorageTokenName());\n    const token_expires_ms = localStorage.getItem(this.getLocalStorageTokenName() + '-expires_ms');\n\n    if (access_token && 0 + token_expires_ms - new Date().getTime() > 30000 && !this.state.authenticationRequired) {\n      console.log(\n        'CheckAuth no check required: authenticationRequired, expires in:',  token_expires_ms - new Date().getTime()\n      );\n      return;\n    }\n\n    const headers = {\n      Authorization: `Bearer ${access_token}`,\n    };\n\n    const userResp = await fetch('https://api.spotify.com/v1/me', { headers }).then(r => r.json());\n\n    if (userResp.error) {\n      if (userResp.error.status === 401) {\n        // Have a token but it is old\n        if (access_token && 0 + token_expires_ms - new Date().getTime() < 0) {\n          return this.authenticateSpotify();\n        }\n        // no token - show login button\n        return this.setState({ authenticationRequired: true });\n      }\n      console.error('This should never happen:', response);\n      return this.setState({ error: response.error });\n    }\n\n    if (hashParams.get('access_token')) {\n      const expires_in = hashParams.get('expires_in');\n      localStorage.setItem(this.getLocalStorageTokenName(), access_token);\n      localStorage.setItem(this.getLocalStorageTokenName() + '-expires_ms', new Date().getTime() + expires_in * 1000);\n\n      // Auth success, remove the parameters from spotify\n      const newurl = window.location.href.split('#')[0];\n      window.history.pushState({ path: newurl }, '', newurl);\n    }\n\n    this.setState({ authenticationRequired: false });\n  }\n\n  async refreshPlayData() {\n    if (document.hidden || this.state.authenticationRequired) {\n      return;\n    }\n    await this.checkAuthentication();\n\n    const headers = {\n      Authorization: `Bearer ${localStorage.getItem(this.getLocalStorageTokenName())}`,\n    };\n\n    let playlists;\n    if (this.state.playlists.length > 0) {\n      playlists = this.state.playlists;\n    } else {\n      if (this.props.featuredPlaylists) {\n        let url = 'https://api.spotify.com/v1/browse/featured-playlists?limit=' + this.props.limit;\n        if (this.props.featuredPlaylistsCountryCode !== \"\") {\n          url += \"&country=\" + this.props.featuredPlaylistsCountryCode;\n        }\n        playlists = await fetch(url, {\n          headers,\n        })\n          .then(r => r.json())\n          .then(r => r.playlists.items);\n      } else if (this.props.dailyMixes) {\n        const res = await this.props.hass.callWS({\n          type: 'spotcast/playlists',\n          playlist_type: 'discover-weekly'\n        });\n        console.log(\"HERE:\", res);\n        playlists = res.items;\n      } else {\n        playlists = await fetch('https://api.spotify.com/v1/me/playlists?limit=' + this.props.limit, { headers })\n          .then(r => r.json())\n          .then(p => p.items);\n      }\n    }\n\n    const devices = await fetch('https://api.spotify.com/v1/me/player/devices', { headers })\n      .then(r => r.json())\n      .then(r => r.devices);\n\n    const currentPlayerRes = await fetch('https://api.spotify.com/v1/me/player', { headers });\n\n    let selectedDevice,\n      playingPlaylist = null,\n      currentPlayer = null;\n    // 200 is returned when something is playing. 204 is ok status without body.\n    if (currentPlayerRes.status === 200) {\n      currentPlayer = await currentPlayerRes.json();\n      // console.log('Currently playing:', currentPlayer);\n      selectedDevice = currentPlayer.device;\n      if (currentPlayer.context && currentPlayer.context.external_urls) {\n        const currPlayingHref = currentPlayer.context.external_urls.spotify;\n        playingPlaylist = playlists.find(pl => currPlayingHref === pl.external_urls.spotify);\n      }\n    }\n\n    this.setState({ playlists, devices, selectedDevice, playingPlaylist, currentPlayer });\n  }\n\n  authenticateSpotify() {\n    const redirectUrl = window.location.href.split('?')[0];\n    const { clientId } = this.props;\n    window.location.href = `https://accounts.spotify.com/authorize?client_id=${clientId}&redirect_uri=${redirectUrl}&scope=${this.scopes.join(\n      '%20'\n    )}&response_type=token`;\n  }\n\n  playPlaylist() {\n    const { selectedPlaylist, selectedDevice } = this.state;\n    if (!selectedPlaylist || !selectedDevice) {\n      console.error('Will not play because there is no playlist or device selected,', selectedPlaylist, selectedDevice);\n      return;\n    }\n    fetch('https://api.spotify.com/v1/me/player/play?device_id=' + selectedDevice.id, {\n      method: 'PUT',\n      headers: {\n        'Content-Type': 'application/json',\n        Authorization: `Bearer ${localStorage.getItem(this.getLocalStorageTokenName())}`,\n      },\n      body: JSON.stringify({ context_uri: selectedPlaylist.uri }),\n    }).then(() => this.setState({ playingPlaylist: selectedPlaylist }));\n  }\n\n  onPlaylistSelect(playlist) {\n    this.setState({ selectedPlaylist: playlist });\n    this.playPlaylist();\n  }\n\n  onMediaPlayerSelect(device) {\n    this.setState({ selectedDevice: device });\n\n    if (this.state.currentPlayer) {\n      fetch('https://api.spotify.com/v1/me/player', {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem(this.getLocalStorageTokenName())}`,\n        },\n        body: JSON.stringify({ device_ids: [device.id], play: true }),\n      });\n    }\n  }\n\n  onChromecastDeviceSelect(device) {\n    const playlist = this.state.playingPlaylist ? this.state.playingPlaylist : this.state.playlists[0];\n    if (!playlist) {\n      console.error('Nothing to play, skipping starting chromecast device');\n      return;\n    }\n    console.log('onChromecastDeviceSelect', device);\n    const options = {\n      device_name: device,\n      uri: playlist.uri,\n      force_playback: this.state.currentPlayer != null,\n      random_song: (this.props.random_song?this.props.random_song : false),\n    };\n\n    if (this.props.account) {\n      options.account = this.props.account;\n    }\n\n    this.props.hass.callService('spotcast', 'start', options);\n  }\n\n  getHighlighted(playlist) {\n    const { selectedPlaylist } = this.state;\n    const selectedPlaylistId = selectedPlaylist ? selectedPlaylist.id : '';\n    return playlist.id === selectedPlaylistId ? 'highlight' : '';\n  }\n\n  getIsPlayingClass(playlist) {\n    const { playingPlaylist } = this.state;\n    const playingPlaylistId = playingPlaylist ? playingPlaylist.id : '';\n    return playlist.id === playingPlaylistId ? 'playing' : '';\n  }\n\n  render() {\n    const { authenticationRequired, playlists, devices, selectedDevice } = this.state;\n    if (authenticationRequired) {\n      return html`\n        <div class=\"spotify_container\">\n          <${Header} />\n          <div class=\"login__box\">\n            <button class=\"greenButton\" onClick=${() => this.authenticateSpotify()}>AUTHENTICATE</button>\n          </div>\n        </div>\n      `;\n    }\n\n    const playlistStyle = { height: this.props.height ? parseInt(this.props.height) : 'auto' };\n\n    return html`\n      <div class=\"spotify_container\">\n        <${Header} />\n        <div class=\"playlists\" style=${playlistStyle}>\n          ${playlists.map((playlist, idx) => {\n            const image = playlist.images[0]\n              ? playlist.images[0].url\n              : 'https://via.placeholder.com/150x150.png?text=No+image';\n            return html`\n              <div\n                class=\"${`playlist ${this.getHighlighted(playlist)}`}\"\n                onClick=${event => this.onPlaylistSelect(playlist, idx, event, this)}\n              >\n                <div class=\"playlist__cover_art\"><img src=\"${image}\" /></div>\n                <div class=\"playlist__number\">${idx + 1}</div>\n                <div class=\"${`playlist__playicon ${this.getIsPlayingClass(playlist)}`}\">►</div>\n                <div class=\"playlist__title\">${playlist.name}</div>\n              </div>\n            `;\n          })}\n        </div>\n          <${PlayerSelect}\n            devices=${devices}\n            selectedDevice=${selectedDevice}\n            hass=${this.props.hass}\n            player=${this.props.player}\n            onMediaplayerSelect=${device => this.onMediaPlayerSelect(device)}\n            onChromecastDeviceSelect=${device => this.onChromecastDeviceSelect(device)}\n          />\n        </div>\n    `;\n  }\n}\n\nconst Header = () => html`\n  <div class=\"header\">\n    <img src=\"https://storage.googleapis.com/pr-newsroom-wp/1/2018/11/Spotify_Logo_RGB_White.png\" />\n  </div>\n`;\n","/**\n * @license\n * Copyright 2019 Niklas Fondberg<niklas.fondberg@gmail.com>. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport 'core-js/stable';\nimport { h, Component, render } from 'preact';\nimport htm from 'htm';\nconst html = htm.bind(h);\nimport SpotifyCard from './SpotifyCard';\n\nconst styleElement = document.createElement('style');\nconst styles = {\n  green: 'rgb(30, 215, 96)',\n  lightBlack: 'rgb(40, 40, 40)',\n  black: 'rgb(24, 24, 24)',\n  grey: 'rgb(170, 170, 170)',\n  sand: 'rgb(200, 200, 200)',\n  white: 'rgb(255, 255, 255)',\n  blue: '#4688d7',\n};\n\nstyleElement.textContent = `\n    .spotify_container {\n      background-color: ${styles.lightBlack};\n      font-family: 'Roboto', sans-serif;\n      color:  ${styles.white};\n      font-size: 14px;\n      padding: 25px;\n      height:auto;\n      overflow-y:auto;\n      position: relative;\n    }\n    .spotify_container *:focus {outline:none}\n    .header img {\n      height: 30px;\n      margin-bottom: 10px;\n    }\n    .login__box {\n      width: 100%;\n      text-align: center;\n    }\n    .playlists {\n      display: flex;\n      flex-flow: column nowrap;\n      margin-bottom: 15px;\n      overflow: auto;\n      background-color: ${styles.black};\n    }\n    .playlist {\n      display: flex;\n      flex-flow: row nowrap;\n      align-items: center;\n      border-top: 1px solid ${styles.lightBlack};\n    }\n    .playlist:active {\n      background-color: rgb(200, 200, 240);\n    }\n    .playlist:last-child {\n      border-bottom: 1px solid ${styles.lightBlack};\n    }\n    .playlist:hover {\n      background: ${styles.lightBlack};\n      cursor: pointer;\n    }\n    .highlight {\n      background: ${styles.lightBlack};\n    }\n\n    .playlist__cover_art img {\n      width: 42px;\n      height: 42px;\n    }\n    .playlist__number {\n      margin-left: 10px;\n      color:  ${styles.grey};\n      width: 12px;\n    }\n\n    .playlist__playicon {\n      color: ${styles.white};\n      margin-left: 10px;\n    }\n    .playlist__playicon:hover {\n      color: rgb(216, 255, 229);\n      text-shadow: 0 0 20px rgb(216, 255, 229);\n    }\n    .playing {\n      color: ${styles.green}\n    }\n\n    .playlist__title {\n      margin-left: 30px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n      max-width: 75vw;\n    }\n    .controls {\n      display: flex;\n      flex-flow: row nowrap;\n      align-items: center;\n      bottom: 0.5em;\n      position: absolute;\n    }\n    .greenButton {\n      border-radius: 15px;\n      padding: 0 20px 0 20px;\n      font-size: 14px;\n      height: 27px;\n      color: white;\n      border: none;\n      background: ${styles.green};\n      cursor: pointer;\n      margin-right: 10px;\n    }\n    .greenButton:hover {\n      background-color: #43e57d;\n    }\n    .playButton::before {\n      content: \"\\\\25B6  \"\n    }\n\n    .dropdown {\n      position: relative;\n      display: inline-block;\n      color: ${styles.sand};\n    }\n    .mediaplayer_select {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    }\n    .mediaplayer_speaker_icon {\n      display: inline-block;\n      padding: 3px;\n      width: 17px;\n      height: 17px;\n      margin-right: 10px;\n      border: thin solid ${styles.sand};\n      border-radius: 50%;\n    }\n    .dropdown-wrapper {\n      display: contents;\n      position: absolute;\n      top: 0;\n      bottom: 0;\n      left: 0;\n      right: 0;\n    }\n    .dropdown-content {\n      display: none;\n      position: absolute;\n      left: 1em;\n      bottom: 0.5em;\n      max-height: calc(100% - 1em);\n      overflow-y: auto;\n      background-color: ${styles.lightBlack};\n      min-width: 250px;\n      box-shadow: black 0 0 16px 0px;\n      z-index: 1;\n    }\n    .dropdown-content a {\n      color: ${styles.sand};\n      padding: 12px 16px;\n      text-decoration: none;\n      display: block;\n    }\n    .dropdown-content a:hover {\n      box-shadow: inset 0 0 100px 100px rgba(255, 255, 255, 0.07);\n    }\n    .controls:hover+.dropdown-content, .dropdown-content:hover {\n      display: block;\n    }\n`;\n\nclass SpotifyCardWebComponent extends HTMLElement {\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: 'open' });\n    this.config = {};\n  }\n\n  set hass(hass) {\n    // console.log('HASS:', hass);\n    if (!this.savedHass) {\n      this.savedHass = hass;\n    }\n  }\n\n  setConfig(config) {\n    if (!config.client_id) {\n      throw new Error('No client ---- id');\n    }\n    this.config = config;\n  }\n\n  getCardSize() {\n    return 10;\n  }\n\n  disconnectedCallback() {\n    this.shadow.innerHTML = '';\n  }\n\n  connectedCallback() {\n    if (!this.config.client_id) {\n      this.config.client_id = this.getAttribute('client_id');\n    }\n    const mountPoint = document.createElement('div');\n    this.shadow.appendChild(styleElement.cloneNode(true));\n    this.shadow.appendChild(mountPoint);\n    render(\n      html`\n        <${SpotifyCard}\n          clientId=${this.config.client_id}\n          limit=${this.config.limit || 10}\n          player=${this.config.device || '*'}\n          hass=${this.savedHass}\n          featuredPlaylists=${this.config.featuredPlaylists || false}\n          featuredPlaylistsCountryCode=${this.config.featuredPlaylistsCountryCode || \"\"}\n          dailyMixes=${this.config.dailyMixes || false}\n          account=${this.config.account || ''}\n          height=${this.config.height || ''}\n          random_song=${this.config.random_song || false}\n        />\n      `,\n      mountPoint\n    );\n  }\n}\ncustomElements.define('spotify-card', SpotifyCardWebComponent);\n"],"names":["n","u","i","t","o","r","e","c","a","s","l","v","parentNode","removeChild","h","arguments","length","push","children","defaultProps","y","key","ref","type","props","__k","__","__b","__e","__d","__c","constructor","__v","vnode","d","m","this","context","w","indexOf","k","base","g","debounceRendering","_","sort","some","f","__P","z","__n","ownerSVGElement","T","b","p","x","A","P","C","Array","isArray","appendChild","nextSibling","insertBefore","value","D","j","setProperty","test","style","cssText","replace","toLowerCase","slice","addEventListener","N","removeEventListener","removeAttributeNS","setAttributeNS","removeAttribute","setAttribute","event","contextType","__E","prototype","render","E","sub","state","__h","__s","getDerivedStateFromProps","componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","__r","getChildContext","getSnapshotBeforeUpdate","$","diffed","call","nodeType","localName","document","createTextNode","createElementNS","createElement","is","data","childNodes","dangerouslySetInnerHTML","attributes","name","__html","innerHTML","checked","current","unmount","componentWillUnmount","getDerivedStateFromError","setState","componentDidCatch","forceUpdate","Promise","then","bind","resolve","setTimeout","Object","assign","apply","Map","get","set","html","htm","PlayerSelect","Component","selectedDevice","castEntities","unsubscribeEntitites","refreshCastEntities","dataRefreshToken","setInterval","async","hass","callWS","filter","platform","map","states","entity_id","clearInterval","selectDevice","device","onMediaplayerSelect","selectChromecastDevice","onChromecastDeviceSelect","devices","choice_form","idx","entitiy","friendly_name","form","player","selected","SpotifyCard","playlists","selectedPlaylist","currentPlayer","playingPlaylist","authenticationRequired","scopes","hidden","refreshPlayData","checkAuthentication","getLocalStorageTokenName","account","hashParams","URLSearchParams","window","location","hash","substring","access_token","localStorage","getItem","token_expires_ms","Date","getTime","console","log","headers","Authorization","userResp","fetch","json","error","status","authenticateSpotify","response","expires_in","setItem","newurl","href","split","history","pushState","path","featuredPlaylists","url","limit","featuredPlaylistsCountryCode","items","dailyMixes","res","playlist_type","currentPlayerRes","external_urls","currPlayingHref","spotify","find","pl","redirectUrl","clientId","join","playPlaylist","id","method","body","JSON","stringify","context_uri","uri","onPlaylistSelect","playlist","onMediaPlayerSelect","device_ids","play","options","device_name","force_playback","random_song","callService","getHighlighted","selectedPlaylistId","getIsPlayingClass","playingPlaylistId","Header","playlistStyle","height","parseInt","image","images","styleElement","styles","textContent","SpotifyCardWebComponent","HTMLElement","shadow","attachShadow","mode","config","savedHass","setConfig","client_id","Error","getCardSize","disconnectedCallback","connectedCallback","getAttribute","mountPoint","cloneNode","customElements","define"],"mappings":"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"}